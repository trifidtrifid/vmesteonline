define("shop-search",["jquery","jquery_ui","shop-initThrift","shop-basket","shop-orders","shop-category","shop-common","shop-spinner"],function(a,b,c,d,e,f,g,h){function i(b,c){var d;d=c?c:a(".catalog"),d.find(".product").each(function(){console.log(a(this).find(".td-producer").data("producerid")),a(this).find(".td-producer").data("producerid")!=b&&a(this).slideUp(0)})}function j(b){for(var d=c.userClient.getAddressCatalogue(),e=d.countries,f=e.length,g=[],h=[],i=[],j=[],k=[],l=[],m=0;f>m;m++)g[m]=e[m].name,h[m]=e[m].id;b.find(".country-delivery").autocomplete({source:g}),b.find(".city-delivery").focus(function(){var e,i=b.find(".country-delivery").val();if(i)for(var j=0;f>j;j++)if(i==g[j]){e=c.userClient.getCities(h[j]);break}e||(e=d.cities);var k=e.length,l=[];for(j=0;k>j;j++)l[j]=e[j].name;a(this).autocomplete({source:l})}),b.find(".street-delivery").focus(function(){var e,f=b.find(".city-delivery").val(),g=d.cities.length;if(f)for(var h=0;g>h;h++)if(f==i[h]){e=c.userClient.getStreets(j[h]);break}e||(e=d.streets);var k=e.length,l=[];for(h=0;k>h;h++)l[h]=e[h].name;a(this).autocomplete({source:l})}),b.find(".building-delivery").focus(function(){var e,f=b.find(".street-delivery").val(),g=d.streets.length;if(f)for(var h=0;g>h;h++)if(f==k[h]){e=c.userClient.getBuildings(l[h]);break}e||(e=d.buildings);var i=e.length,j=[];for(h=0;i>h;h++)j[h]=e[h].fullNo;a(this).autocomplete({source:j})})}if(a.widget("custom.catcomplete",a.ui.autocomplete,{_renderMenu:function(b,c){var d=this,e="";a.each(c,function(a,c){c.category!=e&&(b.append("<li class='ui-autocomplete-category'>"+c.category+"</li>"),e=c.category),d._renderItemData(b,c)})}}),0==a(".login-layout").length&&0==a(".backoffice").length&&0==a(".shop-landing").length){for(var k=a(".main-container.shop").attr("id"),l=c.client.getProductsByCategories(k),m=l.length,n=0,o=[],p=0;m>p;p++)for(var q=l[p].childs.length,r=0;q>r;r++)o[n++]={label:l[p].childs[r].name,productId:l[p].childs[r].id,category:l[p].name};a("#search").catcomplete({delay:0,source:o,select:function(b,c){b.preventDefault();require("shop-common");a(".form-search").trigger("submit"),a(".catalog .product").each(function(){a(this).data("productid")==c.item.productId&&a(this).find(".product-link").trigger("click")})}})}return a(".form-search").submit(function(b){b.preventDefault(),a(".ui-autocomplete").hide();for(var d=a("#search").val().toLowerCase(),e=c.client.getProducts(0,1e3,0),g=e.products,i=g.length,j=[],k=0,l=0;i>l;l++)-1!=g[l].name.toLowerCase().indexOf(d)&&(j[k++]=g[l]);a(".main-content .catalog table tbody").html("").append(f.createProductsTableHtml(j)),a(".main-content .catalog").addClass("searched").attr("data-searchWord",d),h.initProductsSpinner();var m=require("shop-common");m.InitProductDetailPopup(a(".product-link")),m.markAddedProduct();var n=require("shop-basket");n.InitAddToBasket(a(".fa-shopping-cart"))}),a(".producer-dropdown .dropdown-menu").find("li").click(function(){var b=a(this).data("producerid");a(this).closest(".btn-group").find(".btn").data("producerid",b);var c=a(".catalog");if(c.hasClass("searched")){{c.data("searchWord")}a(".form-search").trigger("submit")}else{var d=document.location.hash;d?f.LoadCategoryByURLHash(d):0==a(this).attr("data-producerid")&&f.InitLoadCategory(0)}0!=b&&i(b,c)}),{initAutocompleteAddress:j,filterByProducer:i}});