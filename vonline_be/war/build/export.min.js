define("export.min",["jquery","shop-initThrift.min","bo-common.min","multiselect"],function(a,b,c){function d(){function d(b){var c,d=[],e=0,f=[];counter=0;var g=[],h=a(".ui-multiselect-menu:eq(0) .ui-multiselect-checkboxes li");switch(h.each(function(){a(this).hasClass("ui-multiselect-optgroup-label")&&(g[counter++]=a(this).index())}),b){case"orders":var i=h.slice(g[0]+1,g[1]);c=i.find('input[aria-selected="true"]');break;case"orderLine":i=h.slice(g[1]+1),c=i.find('input[aria-selected="true"]');break;case"products":var j=a(".ui-multiselect-menu:eq(1) .ui-multiselect-checkboxes li");c=j.find('input[aria-selected="true"]');break;case"packs":var k=a(".ui-multiselect-menu:eq(2) .ui-multiselect-checkboxes li");c=k.find('input[aria-selected="true"]')}return counter=0,c.each(function(){d[e++]=parseInt(a(this).val()),f[counter++]=a(this).find("+span").text()}),{fieldsMap:d,headColArray:f}}function e(b,c,d,e){var h=a(".tab-pane.active").find(".export-table");h.html("");for(var i=[],j=c-1;j>=0;j--){i=[];for(var k=b.data[j].fieldsData,l=k.rowCount,m=Math.ceil(k.elems.length/l),n=0,o=0;l>o;o++){i[o]=[];for(var p=0;m>p;p++)i[o][p]=k.elems[n++]}var q,r=0;b.data[j].fieldsMap?(q=d.headColArray,e&&(q=j==c-1?d.headColArray:e.headColArray)):(q=i[0],r=1);var s='<div class="export-single-table"><table><thead><tr>'+f(q)+"</tr></thead><tbody>"+g(i,m,r)+"</tbody></table></div>";s+='<div class="report-link"><a href="'+b.data[j].url+'">Скачать отчет</a>',h.append(s)}}function f(a){var b="",c=a.length;for(i=0;c>i;i++)b+="<td>"+a[i]+"</td>";return b}function g(a,b,c){function d(a,b){for(var c,d="",e="",f=0;b>f;f++)e=a[f],e&&e.length>30&&(c=e,e=e.slice(0,30),e+=" <a class='show-full-text' href='#'>...</a>"+'<div class="full-text"><a href="#" class="close">×</a>'+c+"</div>"),d+="<td>"+e+"</td>";return d}for(var e="",f=a.length,g=c;f>g;g++)e+="<tr>"+d(a[g],b)+"</tr>";return e}a(".export-orders-checklist select, .export-products-checklist select, .export-packs-checklist select").multiselect({noneSelectedText:"Опции",selectedText:"Опции (# выбрано)",checkAllText:"Выбрать все",uncheckAllText:"Отменить все"}),a(".ui-multiselect").addClass("btn btn-sm btn-info no-border"),a(".ui-multiselect .ui-icon").addClass("icon-caret-down"),a(".export .nav-tabs").find("li").click(function(){var b=a(this).index(),d=a(".export .tab-pane:eq("+b+")").addClass("active").height();c.setSidebarHeight(d)}),a(".export-btn").click(function(f){f.preventDefault();var g=a(this).closest(".tab-pane"),h=g.find(".export-delivery-dropdown .btn-group-text").text(),i=g.find(".datepicker-export").attr("data-selectorderdate");if(i){g.find(".error-info").hide(),g.find(".confirm-info").hide();var j=a(".export .nav-tabs").find("li"),k=0;j.each(function(){a(this).hasClass("active")&&(k=a(this).index())});var l;l="Тип доставки"!=h&&"Все"!=h?c.getDeliveryTypeByText(h):0;var m;try{switch(k){case 0:var n=d("orders"),o=d("orderLine");m=b.clientBO.getTotalOrdersReport(i,l,n.fieldsMap,o.fieldsMap);var p;m.data&&(p=m.data.length,e(m,p,n,o));break;case 1:var q=d("products");m=b.clientBO.getTotalProductsReport(i,l,q.fieldsMap),m.data&&(p=m.data.length,e(m,p,q));break;case 2:q=d("packs"),m=b.clientBO.getTotalPackReport(i,l,q.fieldsMap),m.data&&(p=m.data.length,e(m,p,q))}initShowFullText(),initCloseFullText(),m.data||g.find(".confirm-info").text("Нет данных на такое сочетание даты и типа доставки.").show(),c.setSidebarHeight(0)}catch(f){g.find(".confirm-info").text("Ошибка экспорта.").show()}}else g.find(".error-info").text("Пожалуйста, укажите дату с заказом.").show()})}return{initExport:d}});