define("shop-orders.min",["jquery","shop-initThrift.min","shop-basket.min","shop-common.min","shop-spinner.min"],function(a,b,c,d,e){function f(a,c){try{var d='<section class="catalog"><table><thead><tr><td>Название</td><td>Производитель</td><td>Цена (руб)</td><td>Количество</td><td>Стоимость</td><td>Ед.изм</td><td></td></tr></thead>',e=a.odrerLines,f=e.length;q=q?q:b.client.getProducers(),r=r?r:q.length;for(var g=0;f>g;g++){for(var h,i,j,k="",l=0;r>l;l++)if(q[l].id==e[g].product.producerId){i=q[l].name,j=q[l].id;break}if(m=require("shop-common.min"),h=e[g].product.imageURL?e[g].product.imageURL:m.noPhotoPic,e[g].product.unitName&&(k=e[g].product.unitName),d+='<tr class="product" data-prepack="'+e[g].product.prepackRequired+'" data-productid="'+e[g].product.id+'"><td><a href="#" class="product-link"><div class="product-pic"><img src="'+h+'?w=40&h=40" alt="'+e[g].product.name+'"/></div><span><span class="product-name">'+e[g].product.name+"</span>"+e[g].product.shortDescr+'</span></a><div class="modal"></div></td><td class="td-producer" data-producerid="'+j+'">'+i+'</td><td class="product-price">'+e[g].product.price+'</td><td class="td-spinner">',c)d+=e[g].quantity;else{d+='<input type="text"';var m=require("shop-common.min");e[g].packs&&m.getPacksLength(e[g].packs)>1&&(d+='disabled="disabled"'),d+=' data-step="'+e[g].product.minClientPack+'" class="input-mini spinner1" />'}d+='<span class="added-text">добавлен</span></td><td class="orderLine-amount"><span>'+(e[g].product.price*e[g].quantity).toFixed(1)+'</span></td><td><span class="unit-name">'+k+"</span></td>",c||(d+='<td><a href="#" title="Добавить в корзину" class="fa fa-shopping-cart"></a><span href="#" title="Продукт уже у вас в корзине" class="fa fa-check"></span></td>'),d+="</tr>"}d+="</table></section>"}catch(n){alert(n+" Функция createOrdersProductHtml")}return d}function g(b,c){try{var d="",e=b.length,f=0,g=10;c&&(g=t,e-=s),e>g&&(f=e-g);for(var h=e-1;h>=f;h--){var i,j=new Date(1e3*b[h].date);switch(b[h].status){case 0:i="Неизвестен";break;case 1:i="Не подтвержден";break;case 2:i="Подтвержден";break;case 3:i="Уже едет";break;case 4:i="Доставлен";break;case 5:i="Закрыт";break;case 6:i="Отменен"}var k=j.getDate();k=10>k?"0"+k:k;var l=j.getMonth()+1;l=10>l?"0"+l:l;var m=require("shop-basket.min"),n=m.getWeekDay(j.getDay());d+='<div class="order-item orders-no-init" data-orderid="'+b[h].id+'"><table class="orders-tbl"><tbody><tr><td class="td1"><a class="fa fa-plus plus-minus" href="#"></a></td><td class="td2">'+b[h].id+'</td><td class="td3">'+k+"."+l+" ("+n+')</td><td class="td4"><div class="order-status">'+i+'</div></td><td class="td9"></td><td class="td8"></td><td class="td6">'+b[h].totalCost.toFixed(1)+'</td></tr></tbody></table><div class="order-bottom"><a href="#" title="Удалить" class="delete-order-from-history">&times;</a><button class="btn btn-sm btn-primary no-border repeat-order-btn">Повторить</button><button class="btn btn-sm btn-primary no-border add-order-btn">Добавить</button><div class="order-delivery"></div></div><div class="order-products"></div></div>'}var o=e%g;o&&o!=e?d+='<div class="more-orders"><a href="#">Показать еще</a></div>':a(".more-orders").hide()}catch(p){}return d}function h(a,c,d){var e=d?d:b.client.getOrderDetails(c);a.find(".td9").text(e.deliveryCost),a.find(".td8").text((e.weightGramm/1e3).toFixed(1));var f;switch(e.delivery){case 0:f="Неизвестно";break;case 1:f="Самовывоз";break;case 2:f="Курьер рядом";break;case 3:f="Курьер далеко"}a.find(".order-delivery").html("<span><b>Доставка:</b> "+f+",  "+e.deliveryTo.city.name+", "+e.deliveryTo.street.name+" "+e.deliveryTo.building.fullNo+", кв."+e.deliveryTo.flatNo+"</span>")}function i(){a(".delete-order-from-history").click(function(c){c.preventDefault();var d=a(this).closest(".order-item"),e=d.data("orderid");b.client.deleteOrder(e),a(this).closest(".order-item").slideUp()})}function j(c){try{c.find(".plus-minus").click(function(c){c.preventDefault();var d=a(this).closest(".order-item"),g=d.find(".order-products"),i=d.data("orderid");if(0==g.find(".catalog").length){var j=b.client.getOrderDetails(i),k=j.odrerLines,l=k.length;h(d,i,j),g.append(f(j));for(var m=0;l>m;m++){var n=g.find("tbody tr:eq("+m+") .spinner1"),o=g.find("tbody tr:eq("+m+") .spinner1").data("step");e.InitSpinner(n,k[m].quantity,0,o),"disabled"==n.attr("disabled")&&n.closest(".ace-spinner").spinner("disable")}var p=require("shop-basket.min"),q=require("shop-common.min");p.InitAddToBasket(g.find(".fa-shopping-cart")),q.InitProductDetailPopup(g.find(".product-link")),q.markAddedProduct()}g.slideToggle(200,function(){a(".main-content").height()>a(window).height()?a("#sidebar, .shop-right").css("height",a(".main-content").height()+45):a("#sidebar, .shop-right").css("height","100%")}),a(this).hasClass("fa-plus")?a(this).removeClass("fa-plus").addClass("fa-minus"):a(this).removeClass("fa-minus").addClass("fa-plus")})}catch(d){alert(d+" Функция initOrderPlusMinus")}}function k(c,d){try{var e,f,g,h,i=a(".tab-pane.active"),j=i.data("orderid"),k=require("shop-basket.min");if(!j){var l=b.client.createOrder(0);j=l.id;var m=new Date(1e3*l.date);k.addTabToBasketHtml(m,j),i=a(".tab-pane.active")}if("replace"==d){e=b.client.getOrderDetails(c);var n=e.odrerLines,o=n.length;for(h=0;o>h;h++){f=n[h].product,g=n[h].quantity;var p=n[h].packs;b.client.setOrderLine(j,f.id,g,"",p)}}else"append"==d&&(e=b.client.appendOrder(j,c));n=e.odrerLines,o=n.length;var q;for(h=0;o>h;h++){f=n[h].product,g=n[h].quantity,q=!1;var r=require("shop-common.min");n[h].packs&&r.getPacksLength(n[h].packs)>1&&(q=!0),k.AddSingleProductToBasket(f,g,q)}r.markAddedProduct(),i.find(".weight span").text(r.getOrderWeight(c))}catch(s){alert(s+" Функция addSingleOrderToBasket")}}function l(b){try{var c;c=b.itsAppend?"append":"replace",a(".catalog-order").html(""),k(b.orderId,c)}catch(d){alert(d+" Функция AddOrdersToBasket")}}function m(b){try{b.find(".repeat-order-btn").click(function(){var b={itsOrder:!0,itsAppend:!1,orderId:a(this).closest(".order-item").data("orderid")};l(b)}),b.find(".add-order-btn").click(function(){var b={itsOrder:!0,itsAppend:!0,orderId:a(this).closest(".order-item").data("orderid")};a(".additionally-order").hasClass("hide")||l(b)})}catch(c){alert(c+" Функция initOrderBtns")}}function n(){s=10,t=10}function o(b){try{a(".more-orders").click(function(c){c.preventDefault();var d=a(".orders-list");d.find(".more-orders").remove();var e=!0;d.append(g(b,e)),o(b),initOrdersLinks();var f=a(".orders-no-init");j(f),m(f),f.removeClass("orders-no-init"),s+=t;var h=require("shop-common.min");h.setSidebarHeight()})}catch(c){alert(c+" Функция initShowMoreOrders")}}function p(){a(".go-to-orders").trigger("click")}var q,r,s=10,t=10;return{createOrdersProductHtml:f,createOrdersHtml:g,initOrderPlusMinus:j,addSingleOrderToBasket:k,AddOrdersToBasket:l,initOrderBtns:m,initVarForMoreOrders:n,initShowMoreOrders:o,GoToOrdersTrigger:p,showOrderDetails:h,deleteOrderFromHistory:i}});